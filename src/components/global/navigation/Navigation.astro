---
// Assets
import Logo from "@/components/assets/Logo.astro";
// Foundations
import Wrapper from "@/components/fundations/containers/Wrapper.astro";
// Components
import DocsSearch from "@/components/docs/DocsSearch.astro";
import ThemeToggle from "@/components/fundations/elements/ThemeToggle.astro";
import LogoContextMenu from "@/components/global/LogoContextMenu.astro";
// Icons
import Menu from "@/components/fundations/icons/Menu.astro";
import Github from "@lucide/astro/icons/github";
export interface Props {
  variant?: "default" | "docs";
}
const { variant = "default" } = Astro.props;
const navLinks = [
  { title: "Docs", href: "/docs" },
  {
    title: "Astro themes",
    href: "https://lexingtonthemes.com/",
    external: true,
  },
];
// GitHub repo info
const githubRepo = "michael-andreuzza/bearnie";
---

{
  variant === "docs" ? (
    <header class="sticky top-0 z-50 w-full bg-muted">
      <Wrapper variant="standard">
        <div class="flex py-4 items-center justify-between ">
          <LogoContextMenu>
            <a href="/" class="font-semibold flex items-center gap-2">
              <Logo class="size-4" />
              bearnie
            </a>
          </LogoContextMenu>
          <div class="hidden md:flex items-center gap-4">
            <nav class="flex items-center gap-4 text-sm font-medium">
              {navLinks.map((link) => (
                <a
                  href={link.href}
                  class="text-muted-foreground hover:text-foreground transition-colors whitespace-nowrap"
                  {...(link.external
                    ? { target: "_blank", rel: "noopener noreferrer" }
                    : {})}
                >
                  {link.title}
                </a>
              ))}
            </nav>
            <div class="flex items-center border-l border-border pl-4 gap-1">
              <a
                href={`https://github.com/${githubRepo}`}
                target="_blank"
                rel="noopener noreferrer"
                class="inline-flex items-center justify-center gap-1.5 h-7 px-2 rounded-md text-sm text-muted-foreground hover:text-foreground hover:bg-accent transition-colors"
                aria-label="GitHub"
              >
                <Github class="size-3.5" />
                <span id="github-stars-docs" class="tabular-nums" />
              </a>
              <DocsSearch />
              <ThemeToggle size="xs" />
            </div>
          </div>
          <div class="flex items-center gap-1 md:hidden">
            <DocsSearch />
            <a
              href={`https://github.com/${githubRepo}`}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center justify-center size-5 text-muted-foreground hover:text-foreground transition-colors"
              aria-label="GitHub"
            >
              <Github class="size-4" />
            </a>
            <ThemeToggle size="xs" />
            <button
              type="button"
              class="inline-flex items-center justify-center size-7 text-muted-foreground"
              id="docs-mobile-menu-toggle"
              aria-label="Toggle menu"
            >
              <Menu size="md" />
            </button>
          </div>
        </div>
      </Wrapper>
    </header>
  ) : (
    <header class="sticky top-0 z-50 w-full bg-background">
      <Wrapper variant="standard">
        <div class="mx-auto flex py-4 items-center justify-between">
          <LogoContextMenu>
            <a href="/" class="font-semibold flex items-center gap-2">
              bearnie
            </a>
          </LogoContextMenu>
          <div class="flex items-center gap-4">
            <nav class="flex items-center gap-6 text-sm">
              {navLinks.map((link) => (
                <a
                  href={link.href}
                  class="text-muted-foreground hover:text-foreground transition-colors"
                  {...(link.external
                    ? { target: "_blank", rel: "noopener noreferrer" }
                    : {})}
                >
                  {link.title}
                </a>
              ))}
            </nav>
            <ThemeToggle size="xs" />
          </div>
        </div>
      </Wrapper>
    </header>
  )
}
<script define:vars={{ githubRepo }}>
  // Fetch GitHub stars
  async function fetchGitHubStars() {
    try {
      const response = await fetch(
        `https://api.github.com/repos/${githubRepo}`,
      );
      if (response.ok) {
        const data = await response.json();
        const stars = data.stargazers_count;
        const formatted =
          stars >= 1000 ? `${(stars / 1000).toFixed(1)}k` : stars.toString();
        // Update both star elements if they exist
        const docsStars = document.getElementById("github-stars-docs");
        const defaultStars = document.getElementById("github-stars-default");
        if (docsStars) docsStars.textContent = formatted;
        if (defaultStars) defaultStars.textContent = formatted;
      }
    } catch (error) {
      console.error("Failed to fetch GitHub stars:", error);
    }
  }
  fetchGitHubStars();
</script>
