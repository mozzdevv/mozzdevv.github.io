---
import { cn } from "@/utils/cn";
import type { HTMLAttributes } from "astro/types";

export interface Props extends HTMLAttributes<"button"> {
  value: string;
  variant?: "default" | "outline";
  size?: "sm" | "default" | "lg";
  disabled?: boolean;
}

const {
  value,
  variant = "default",
  size = "default",
  disabled = false,
  class: className,
  ...props
} = Astro.props;

const baseClasses = cn(
  "inline-flex items-center justify-center gap-2 text-sm font-medium",
  "ring-offset-background transition-colors",
  "hover:bg-muted hover:text-muted-foreground",
  "focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
  "disabled:pointer-events-none disabled:opacity-50",
  "[&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  // Pressed state - takes precedence over hover
  "data-[state=on]:bg-accent data-[state=on]:text-accent-foreground"
);

const variantClasses = {
  default: "border border-input bg-transparent",
  outline: "border border-input bg-transparent",
};

const sizeClasses = {
  sm: "h-8 px-2 min-w-8",
  default: "h-9 px-2.5 min-w-9",
  lg: "h-10 px-3 min-w-10",
};

// First and last item rounding, and negative margin to collapse borders
const classes = cn(
  baseClasses,
  variantClasses[variant],
  sizeClasses[size],
  // Rounded corners for first/last items
  "first:rounded-l-md last:rounded-r-md rounded-none",
  // Collapse borders - negative margin to overlap
  "-ml-px first:ml-0",
  className
);
---

<button
  type="button"
  data-toggle-group-item
  data-value={value}
  data-variant={variant}
  data-size={size}
  data-state="off"
  aria-pressed="false"
  disabled={disabled}
  class={classes}
  {...props}
>
  <slot />
</button>
