---
import CodeBlock from "@/components/docs/CodeBlock.astro";
import Dialog from "@/components/ui/dialog/Dialog.astro";
import DialogTrigger from "@/components/ui/dialog/DialogTrigger.astro";
import DialogOverlay from "@/components/ui/dialog/DialogOverlay.astro";
import DialogContent from "@/components/ui/dialog/DialogContent.astro";
import DialogHeader from "@/components/ui/dialog/DialogHeader.astro";
import DialogTitle from "@/components/ui/dialog/DialogTitle.astro";
import DialogDescription from "@/components/ui/dialog/DialogDescription.astro";
import Tooltip from "@/components/ui/tooltip/Tooltip.astro";
import TooltipTrigger from "@/components/ui/tooltip/TooltipTrigger.astro";
import TooltipContent from "@/components/ui/tooltip/TooltipContent.astro";
import Button from "@/components/ui/button/Button.astro";
import Copy from "@lucide/astro/icons/copy";
import Check from "@lucide/astro/icons/check";
import SquareTerminal from "@lucide/astro/icons/square-terminal";

const packageManagers = [
  { id: "npx", label: "npx", command: "npx create-bearnie my-app" },
  { id: "bun", label: "bun", command: "bunx create-bearnie my-app" },
  { id: "pnpm", label: "pnpm", command: "pnpm create bearnie my-app" },
  { id: "yarn", label: "yarn", command: "yarn create bearnie my-app" },
];
---

<Dialog>
  <DialogTrigger class="w-full">
    <Button variant="outline" size="sm" class="w-full">
      <SquareTerminal class="size-4" />
      Create Project
    </Button>
  </DialogTrigger>
  <DialogOverlay />
  <DialogContent class="max-w-[calc(100vw-2rem)] sm:max-w-lg">
    <DialogHeader>
      <DialogTitle>Create Project</DialogTitle>
      <DialogDescription>
        Run this command to create a new Astro + Bearnie project with your theme.
      </DialogDescription>
    </DialogHeader>

    <div class="mt-4 overflow-hidden" data-create-modal>
      <div class="border border-border rounded-lg overflow-hidden">
        <div
          class="flex items-center justify-between px-4 py-2 border-b border-border bg-background"
        >
          <div class="flex items-center gap-2">
            <SquareTerminal class="size-4 text-muted-foreground shrink-0" />
            {
              packageManagers.map((pm, index) => (
                <button
                  type="button"
                  class="px-2.5 py-1 text-xs font-medium text-muted-foreground hover:text-foreground data-active:text-foreground data-active:bg-muted rounded-md transition-colors"
                  data-pm-tab={pm.id}
                  data-active={index === 0 ? "" : undefined}
                >
                  {pm.label}
                </button>
              ))
            }
          </div>
          <Tooltip>
            <TooltipTrigger>
              <button
                type="button"
                class="flex items-center justify-center p-1.5 text-muted-foreground hover:text-foreground rounded-md transition-colors shrink-0"
                data-modal-copy-button
              >
                <Copy size={14} data-copy-icon />
                <Check size={14} class="hidden" data-check-icon />
              </button>
            </TooltipTrigger>
            <TooltipContent class="text-xs px-2 py-1 shadow-none">
              Copy to clipboard
            </TooltipContent>
          </Tooltip>
        </div>

        {
          packageManagers.map((pm, index) => (
            <div class={index === 0 ? "" : "hidden"} data-pm-panel={pm.id}>
              <span class="sr-only" data-code-content>
                {pm.command}
              </span>
              <CodeBlock
                code={pm.command}
                lang="bash"
                class="rounded-none border-0 [&_pre]:overflow-x-auto"
                showCopy={false}
              />
            </div>
          ))
        }
      </div>
    </div>
  </DialogContent>
</Dialog>
