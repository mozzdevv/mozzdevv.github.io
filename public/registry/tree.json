{
  "name": "tree",
  "description": "A hierarchical tree view",
  "category": "navigation",
  "dependencies": [],
  "devDependencies": [],
  "registryDependencies": [],
  "files": [
    {
      "name": "Tree.astro",
      "path": "tree/Tree.astro",
      "content": "---\nimport { cn } from '@/utils/cn';\nimport type { HTMLAttributes } from 'astro/types';\n\nexport interface Props extends HTMLAttributes<'ul'> {\n  label?: string;\n}\n\nconst { label = 'Tree navigation', class: className, ...props } = Astro.props;\n\nconst classes = cn(\n  'tree',\n  className\n);\n---\n\n<ul class={classes} role=\"tree\" aria-label={label} data-tree {...props}>\n  <slot />\n</ul>\n\n<script>\n  function initTrees() {\n    document.querySelectorAll('[data-tree]').forEach((tree) => {\n      if (tree.hasAttribute('data-initialized')) return;\n      tree.setAttribute('data-initialized', 'true');\n\n      // Calculate and set aria-level, aria-setsize, aria-posinset\n      function setAriaAttributes(container: Element, level: number) {\n        const directItems = Array.from(container.children).filter(\n          child => child.matches('[data-tree-item]')\n        );\n\n        directItems.forEach((item, index) => {\n          item.setAttribute('aria-level', String(level));\n          item.setAttribute('aria-setsize', String(directItems.length));\n          item.setAttribute('aria-posinset', String(index + 1));\n\n          // Process children\n          const childrenContainer = item.querySelector('[data-tree-item-children]');\n          if (childrenContainer) {\n            setAriaAttributes(childrenContainer, level + 1);\n          }\n        });\n      }\n\n      // Set ARIA attributes for the entire tree\n      setAriaAttributes(tree, 1);\n\n      // Sync initial hidden state with data-state for all items\n      tree.querySelectorAll('[data-tree-item]').forEach((item) => {\n        const children = item.querySelector(':scope > [data-tree-item-children], :scope > * > [data-tree-item-children]') as HTMLElement;\n        const trigger = item.querySelector(':scope > [data-tree-item-trigger], :scope > * > [data-tree-item-trigger], :scope > * > * > [data-tree-item-trigger]');\n        const folderClosed = trigger?.querySelector('[data-folder-closed]') as HTMLElement;\n        const folderOpen = trigger?.querySelector('[data-folder-open]') as HTMLElement;\n        \n        if (children) {\n          const isOpen = item.getAttribute('data-state') === 'open';\n          children.hidden = !isOpen;\n          \n          // Update folder icons\n          if (folderClosed && folderOpen) {\n            if (isOpen) {\n              folderClosed.classList.add('hidden');\n              folderOpen.classList.remove('hidden');\n            } else {\n              folderClosed.classList.remove('hidden');\n              folderOpen.classList.add('hidden');\n            }\n          }\n        }\n      });\n\n      // Get all visible triggers for navigation\n      const getVisibleTriggers = (): HTMLElement[] => {\n        const triggers: HTMLElement[] = [];\n        \n        const processItem = (item: Element) => {\n          const trigger = item.querySelector(':scope > [data-tree-item-trigger], :scope > * > [data-tree-item-trigger]') as HTMLElement;\n          if (trigger) {\n            triggers.push(trigger);\n          }\n          \n          // If item is open, process children\n          if (item.getAttribute('data-state') === 'open') {\n            const children = item.querySelector('[data-tree-item-children]');\n            if (children) {\n              Array.from(children.children).forEach(child => {\n                if (child.matches('[data-tree-item]')) {\n                  processItem(child);\n                }\n              });\n            }\n          }\n        };\n\n        // Process top-level items\n        Array.from(tree.children).forEach(child => {\n          if (child.matches('[data-tree-item]')) {\n            processItem(child);\n          }\n        });\n\n        return triggers;\n      };\n\n      // Helper to update folder icons\n      const updateFolderIcons = (trigger: Element, isOpen: boolean) => {\n        const folderClosed = trigger.querySelector('[data-folder-closed]') as HTMLElement;\n        const folderOpen = trigger.querySelector('[data-folder-open]') as HTMLElement;\n        if (folderClosed && folderOpen) {\n          if (isOpen) {\n            folderClosed.classList.add('hidden');\n            folderOpen.classList.remove('hidden');\n          } else {\n            folderClosed.classList.remove('hidden');\n            folderOpen.classList.add('hidden');\n          }\n        }\n      };\n\n      // Handle all triggers in the tree\n      tree.querySelectorAll('[data-tree-item-trigger]').forEach((trigger) => {\n        trigger.addEventListener('click', (e) => {\n          e.stopPropagation();\n          const item = trigger.closest('[data-tree-item]');\n          if (!item) return;\n\n          const children = item.querySelector('[data-tree-item-children]') as HTMLElement;\n          if (!children) return;\n\n          const isExpanded = item.getAttribute('data-state') === 'open';\n          \n          if (isExpanded) {\n            item.setAttribute('data-state', 'closed');\n            children.hidden = true;\n            trigger.setAttribute('aria-expanded', 'false');\n            updateFolderIcons(trigger, false);\n          } else {\n            item.setAttribute('data-state', 'open');\n            children.hidden = false;\n            trigger.setAttribute('aria-expanded', 'true');\n            updateFolderIcons(trigger, true);\n          }\n        });\n\n        // Keyboard navigation\n        trigger.addEventListener('keydown', (e: Event) => {\n          const key = (e as KeyboardEvent).key;\n          const item = trigger.closest('[data-tree-item]');\n          if (!item) return;\n\n          const visibleTriggers = getVisibleTriggers();\n          const currentIndex = visibleTriggers.indexOf(trigger as HTMLElement);\n\n          switch (key) {\n            case 'ArrowRight': {\n              const children = item.querySelector('[data-tree-item-children]') as HTMLElement;\n              if (children && item.getAttribute('data-state') !== 'open') {\n                item.setAttribute('data-state', 'open');\n                children.hidden = false;\n                trigger.setAttribute('aria-expanded', 'true');\n                updateFolderIcons(trigger, true);\n              } else if (children && item.getAttribute('data-state') === 'open') {\n                // Move to first child\n                const firstChildTrigger = children.querySelector('[data-tree-item-trigger]') as HTMLElement;\n                firstChildTrigger?.focus();\n              }\n              (e as KeyboardEvent).preventDefault();\n              break;\n            }\n            case 'ArrowLeft': {\n              const children = item.querySelector('[data-tree-item-children]') as HTMLElement;\n              if (children && item.getAttribute('data-state') === 'open') {\n                item.setAttribute('data-state', 'closed');\n                children.hidden = true;\n                trigger.setAttribute('aria-expanded', 'false');\n                updateFolderIcons(trigger, false);\n              } else {\n                // Move to parent\n                const parentItem = item.parentElement?.closest('[data-tree-item]');\n                const parentTrigger = parentItem?.querySelector(':scope > [data-tree-item-trigger], :scope > * > [data-tree-item-trigger]') as HTMLElement;\n                parentTrigger?.focus();\n              }\n              (e as KeyboardEvent).preventDefault();\n              break;\n            }\n            case 'ArrowDown': {\n              (e as KeyboardEvent).preventDefault();\n              if (currentIndex < visibleTriggers.length - 1) {\n                visibleTriggers[currentIndex + 1].focus();\n              }\n              break;\n            }\n            case 'ArrowUp': {\n              (e as KeyboardEvent).preventDefault();\n              if (currentIndex > 0) {\n                visibleTriggers[currentIndex - 1].focus();\n              }\n              break;\n            }\n            case 'Home': {\n              (e as KeyboardEvent).preventDefault();\n              visibleTriggers[0]?.focus();\n              break;\n            }\n            case 'End': {\n              (e as KeyboardEvent).preventDefault();\n              visibleTriggers[visibleTriggers.length - 1]?.focus();\n              break;\n            }\n          }\n        });\n      });\n    });\n  }\n\n  initTrees();\n  document.addEventListener('astro:page-load', initTrees);\n</script>\n"
    },
    {
      "name": "TreeItem.astro",
      "path": "tree/TreeItem.astro",
      "content": "---\nimport { cn } from '@/utils/cn';\nimport type { HTMLAttributes } from 'astro/types';\n\nexport interface Props extends HTMLAttributes<'li'> {\n  defaultOpen?: boolean;\n}\n\nconst { defaultOpen = false, class: className, ...props } = Astro.props;\n\nconst classes = cn(\n  'tree-item',\n  className\n);\n---\n\n<li\n  class={classes}\n  data-tree-item\n  data-state={defaultOpen ? 'open' : 'closed'}\n  role=\"treeitem\"\n  {...props}\n>\n  <slot />\n</li>\n"
    },
    {
      "name": "TreeItemChildren.astro",
      "path": "tree/TreeItemChildren.astro",
      "content": "---\nimport { cn } from '@/utils/cn';\nimport type { HTMLAttributes } from 'astro/types';\n\nexport interface Props extends HTMLAttributes<'ul'> {}\n\nconst { class: className, ...props } = Astro.props;\n\nconst classes = cn(\n  'ml-4 border-l pl-2',\n  className\n);\n---\n\n<ul class={classes} data-tree-item-children role=\"group\" hidden {...props}>\n  <slot />\n</ul>\n"
    },
    {
      "name": "TreeItemContent.astro",
      "path": "tree/TreeItemContent.astro",
      "content": "---\nimport { cn } from '@/utils/cn';\nimport type { HTMLAttributes } from 'astro/types';\n\nexport interface Props extends HTMLAttributes<'div'> {}\n\nconst { class: className, ...props } = Astro.props;\n\nconst classes = cn(\n  'flex items-center gap-2 rounded-md px-2 py-1.5 text-sm',\n  'hover:bg-accent hover:text-accent-foreground',\n  'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring',\n  className\n);\n---\n\n<div class={classes} data-tree-item-content tabindex=\"0\" {...props}>\n  <slot />\n</div>\n"
    },
    {
      "name": "TreeItemTrigger.astro",
      "path": "tree/TreeItemTrigger.astro",
      "content": "---\nimport { cn } from '@/utils/cn';\nimport type { HTMLAttributes } from 'astro/types';\nimport Folder from \"@lucide/astro/icons/folder\";\nimport FolderOpen from \"@lucide/astro/icons/folder-open\";\n\nexport interface Props extends HTMLAttributes<'button'> {\n  /** Show folder icons that change based on state */\n  showFolderIcon?: boolean;\n}\n\nconst { showFolderIcon = true, class: className, ...props } = Astro.props;\n\nconst classes = cn(\n  'inline-flex shrink-0 items-center justify-center rounded-sm',\n  'hover:bg-accent',\n  className\n);\n---\n\n<button\n  type=\"button\"\n  class={classes}\n  data-tree-item-trigger\n  aria-expanded=\"false\"\n  {...props}\n>\n  <slot>\n    {showFolderIcon && (\n      <>\n        <Folder class=\"size-4\" data-folder-closed />\n        <FolderOpen class=\"size-4 hidden\" data-folder-open />\n      </>\n    )}\n  </slot>\n</button>\n"
    }
  ]
}
