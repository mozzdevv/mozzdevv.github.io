{
  "name": "focus-trap",
  "type": "utility",
  "description": "Focus trap utility for modal accessibility",
  "files": [
    {
      "name": "focus-trap.ts",
      "path": "utils/focus-trap.ts",
      "content": "/**\n * Focus Trap Utility\n * Traps focus within a container element for modal accessibility\n */\n\nconst FOCUSABLE_SELECTORS = [\n  'a[href]',\n  'button:not([disabled])',\n  'input:not([disabled])',\n  'select:not([disabled])',\n  'textarea:not([disabled])',\n  '[tabindex]:not([tabindex=\"-1\"])',\n].join(', ');\n\nexport function getFocusableElements(container: HTMLElement): HTMLElement[] {\n  return Array.from(container.querySelectorAll<HTMLElement>(FOCUSABLE_SELECTORS))\n    .filter(el => el.offsetParent !== null); // Filter out hidden elements\n}\n\nexport function trapFocus(container: HTMLElement): () => void {\n  const focusableElements = getFocusableElements(container);\n  const firstFocusable = focusableElements[0];\n  const lastFocusable = focusableElements[focusableElements.length - 1];\n\n  function handleKeyDown(e: KeyboardEvent) {\n    if (e.key !== 'Tab') return;\n\n    const updatedFocusableElements = getFocusableElements(container);\n    const first = updatedFocusableElements[0];\n    const last = updatedFocusableElements[updatedFocusableElements.length - 1];\n\n    if (e.shiftKey) {\n      // Shift + Tab\n      if (document.activeElement === first) {\n        e.preventDefault();\n        last?.focus();\n      }\n    } else {\n      // Tab\n      if (document.activeElement === last) {\n        e.preventDefault();\n        first?.focus();\n      }\n    }\n  }\n\n  container.addEventListener('keydown', handleKeyDown);\n\n  // Focus first element\n  firstFocusable?.focus();\n\n  // Return cleanup function\n  return () => {\n    container.removeEventListener('keydown', handleKeyDown);\n  };\n}\n\nexport function generateId(prefix: string): string {\n  return `${prefix}-${Math.random().toString(36).substring(2, 9)}`;\n}\n"
    }
  ]
}
